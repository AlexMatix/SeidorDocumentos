
<?variable-resolver class="org.zkoss.zkplus.spring.DelegatingVariableResolver"?>
<?init class="org.zkoss.zkplus.databind.AnnotateDataBinderInit" arg0="./ewin"?>

<zk xmlns="http://www.zkoss.org/2005/zul" xmlns:h="native" xmlns:w="client" >
	<window id="ewin" border="none" onCreate="entityController.loadEdit(ebeanDetail, self);" >

		<zscript>
			import ieci.tdw.ispac.adapter.TransactAdapterI;
			import ieci.tdw.ispac.entity.EntityAdapter;

			EntityAdapter ebeanDetail = Executions.getCurrent().getArg().get("adapter");

			update(){
			fcv.validate(ewin);
			entityController.saveOrUpdate(transactDetail, ebeanDetail, ewin);
			}

			TransactAdapterI transactDetail = Executions.getCurrent().getArg().get("transact");
		</zscript>
		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script type="text/javascript">

			var cont = 0;
			function newBlock() {
				console.log("LOG -- ", "GENERANDO NUEVO BLOQUE");
				let block ='<div id="draggable'+ cont +'" class="ui-widget-content ThemeDraggable ">' +
						'<p>Drag me around</p>' +
						'</div>';
				$('#DiagramDraggableContent').append(block);
				$( "#draggable" + cont ).draggable();
			}

		</script>
		<div class="row editBox" >
			<div class="row editHeader">
				<div class="col-md-12" align="right" >
					<custom-attributes removeOnPortal="true" ></custom-attributes>
					<button label="guardar" sclass="btn btn-success" onClick="update();" iconSclass="z-icon-save" ></button>
				</div>
			</div>

			<div id="DiagramContent" class="DiagramContent">
				<div class="row">
					<div class="col-md-3">
						<h:ul class="list-group DiagramMargin">
							<h:li class="list-group-item">
								<button type="button" sclass="btn btn-primary" iconSclass="fa fa-plus" xmlns:w="http://www.zkoss.org/2005/zk/client" w:onClick="newBlock()"></button>
								Nuevo bloque
							</h:li>
							<h:li class="list-group-item">
								<button type="button" sclass="btn btn-primary" iconSclass="fa fa-plus"></button>
								Nueva linea Izquiera
							</h:li>
							<h:li class="list-group-item">
								<button type="button" sclass="btn btn-primary" iconSclass="fa fa-plus"></button>
								Nueva linea Derecha
							</h:li>
						</h:ul>
					</div>

					<div class="col-md-9">
						<div id="DiagramDraggableContent">
							
						</div>
					</div>
				</div>
			</div>

			<!-- Campo para almacenar datos -->
			<div class="row gridCard" visible="true">
				<div class="col-md-12">
					<label value="info_diagrama" sclass="editField" ></label>
					<h:p> <textbox id="info_diagrama" maxlength="0"  ></textbox> </h:p>
				</div>
			</div>

		</div>

		<style>
			.DiagramContent{
				width: 100%;
				height: 900px;
				border:1px solid #000;
				overflow-x: scroll;
				overflow-y: scroll;
			}

			.DiagramMargin{
				margin-top: 15px;
			}

			.ThemeDraggable {
				width: 150px;
				height: 150px;
				padding: 0.5em;
			}

		</style>

	</window>
</zk>
